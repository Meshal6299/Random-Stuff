<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript</title>
    <link rel="shortcut icon" href="Js.png" type="image/x-icon">
    <style>
        body {
            user-select: none;       /* Standard */
            -webkit-user-select: none; /* Chrome/Safari */
            -moz-user-select: none;    /* Firefox */
            -ms-user-select: none;     /* IE/Edge */
            overflow-x: hidden;
        }
        .main{
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            flex-wrap: nowrap;
            gap: 10px;
        }
        form{
            background-color: white;
            display: flex;
            flex-direction: column;
            padding: 15px;
            width: 210px;
            gap: 3px;
            border: 1px solid rgb(163, 163, 163);
        }
        table, th, td {
            border: 1px solid rgb(163, 163, 163);
            border-collapse: collapse;
            background-color: white ;
            padding: 10px;
            text-align: left;
            color: black;
            height: fit-content;
        }
        table {
            width: 800px; /* fixed width prevents border from shifting when rows are removed */
            table-layout: fixed; /* stable column widths */
        }
        th:nth-last-child(1), td:nth-last-child(1) {
            width: 60px; /* fixed width for remove column */
        }
        th:nth-last-child(2), td:nth-last-child(2) {
            width: 45px; /* fixed width for remove column */
        }
        th:nth-last-child(3), td:nth-last-child(3) {
            width: 40px; /* fixed width for remove column */
            text-align: center;
        }
        th, td {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap; /* keep columns stable; change to normal if you want wrapping */
        }
        .status{
            display: flex;
            align-items: center;
            gap: 10px;
            color: rgba(0, 0, 0, 0.6);
        }
        .status , input{
            font-family: Arial, Helvetica, sans-serif;
            font-size: 14px;
        }
        .error {
            color: red;
            font-size: 14px;
            visibility: hidden;
        }
    </style>
</head>
<body style="background-color: aliceblue;">
    <h1 style="text-align: center; color: black;">JavaScript Practice</h1>
    <div class="main">
        <div class="form">
            <form action="">
                <input type="text" placeholder="Book Name" id="bookname">
                <span class="error" id="bookError">fd</span>
                <input type="text" placeholder="Author" id="author">
                <span class="error" id="authorError">fd</span>
                <input type="number" placeholder="Pages" id="pages">
                <span class="error" id="pagesError">fd</span>
                <div class="status">
                    <label for="status">Have you read this book?</label>
                    <input type="checkbox" name="status" id="status">
                </div>
                
                <input type="submit" id="addBookBtn">
                
                
            </form>
        </div>

        <br>
        <table id="bookTable">
        <tr>
            <th>Book Name</th>
            <th>Author</th>
            <th>Pages</th>
            <th>Status</th>
            <th>Remove</th>
        </tr>
        </table>
        <br>
    </div>

    <script>
        let myLibrary = [];

        function Book(name, author, pages, status) {
            this.id = crypto.randomUUID();
            this.name = name;
            this.author = author;
            this.pages = pages;
            this.read = (status.toLowerCase() === "yes"); 
        }

        function saveLibrary() {
            localStorage.setItem("myLibrary", JSON.stringify(myLibrary));
        }

        function loadLibrary() {
            const storedLibrary = localStorage.getItem("myLibrary");
            if (storedLibrary) {
                const parsedLibrary = JSON.parse(storedLibrary);
                myLibrary = parsedLibrary.map(book => new Book(book.name, book.author, book.pages, book.read ? "yes" : "no"));
            }
        }

        function displayBooks() {
            const table = document.getElementById("bookTable");

            // Remove old rows except header
            while (table.rows.length > 1) {
                table.deleteRow(1);
            }

            // Render rows
            myLibrary.forEach(book => {
                const row = document.createElement("tr");
                const nameCell = document.createElement("td");
                const authorCell = document.createElement("td");
                const pagesCell = document.createElement("td");
                const stateCell = document.createElement("td");
                const actionCell = document.createElement("td");
                const deleteBtn = document.createElement("button");
                
                deleteBtn.textContent = "🗑️";
                deleteBtn.style.border = "none";
                deleteBtn.style.background = "none";
                deleteBtn.style.cursor = "pointer";
                actionCell.style.textAlign = "center";

                deleteBtn.addEventListener("click", () => {
                    myLibrary = myLibrary.filter(b => b.id !== book.id);
                    saveLibrary();
                    displayBooks();
                });

                stateCell.addEventListener("click", () => {
                    book.read = !book.read;
                    saveLibrary();
                    displayBooks();
                });

                nameCell.textContent = book.name;
                authorCell.textContent = book.author;
                pagesCell.textContent = book.pages;
                stateCell.textContent = book.read ? "✔️" : "❌";
                stateCell.style.textAlign = "center";
                stateCell.style.cursor = "pointer";
                
                actionCell.appendChild(deleteBtn);

                row.appendChild(nameCell);
                row.appendChild(authorCell);
                row.appendChild(pagesCell);
                row.appendChild(stateCell);
                row.appendChild(actionCell);
                table.appendChild(row);
            });
        }

        document.addEventListener("DOMContentLoaded", () => {

            loadLibrary();

            // Add sample books only if library is empty
            if (myLibrary.length === 0) {
                myLibrary.push(new Book("Atomic Habits", "James Clear", "219", "yes"));
                myLibrary.push(new Book("The Subtle Art of Not Giving a F*ck", "Mark Manson", "224", "no"));
                myLibrary.push(new Book("Deep Work", "Cal Newport", "304", "yes"));
                myLibrary.push(new Book("Cant Hurt Me", "David Goggins", "364", "no"));
                saveLibrary();
            }

            displayBooks();
            document.getElementById("addBookBtn").addEventListener("click", addBook);
        });


        function addBook(event) {
            event.preventDefault();
        
            const nameInput = document.getElementById("bookname");
            const authorInput = document.getElementById("author");
            const pagesInput = document.getElementById("pages");

            const nameError = document.getElementById("bookError");
            const authorError = document.getElementById("authorError");
            const pagesError = document.getElementById("pagesError");

            nameError.style.visibility = "hidden";
            authorError.style.visibility = "hidden";
            pagesError.style.visibility = "hidden";

            const name = nameInput.value;
            const author = authorInput.value;
            const pages = pagesInput.value;
            
            let valid = true;

            if (name.trim() === "") {
                nameError.textContent = "Book name is required.";
                nameError.style.visibility = "visible";
                valid = false;
            }

            if (author.trim() === "") {
                authorError.textContent = "Author name is required.";
                authorError.style.visibility = "visible";
                valid = false;
            }

            if (pages.trim() === "" || isNaN(pages) || Number(pages) <= 0) {
                pagesError.textContent = "Please enter a valid number of pages.";
                pagesError.style.visibility = "visible";
                valid = false;
            }
            if (!valid) return;
            const status = document.getElementById("status").checked ? "yes" : "no";
            const newBook = new Book(name, author, pages, status);
            myLibrary.push(newBook);
            saveLibrary();
            displayBooks();

            // Clear form
            nameInput.value = "";
            authorInput.value = "";
            pagesInput.value = "";
            document.getElementById("status").checked = false;
        
        }
        



    </script>
</body>
</html>
